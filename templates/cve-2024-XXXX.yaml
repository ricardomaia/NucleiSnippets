id: CVE-2024-XXXX

info:
  name: Not found command example
  author: ricardomaia
  severity: info
  description: |
    Trying to execute a command that does not exist and getting a return code of 127.
  reference:
    - https://github.com/ricardomaia/NucleiSnippets
  classification:
    cvss-metrics: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.8
    cve-id: CVE-2024-XXXX
    cwe-id: CWE-787
    cpe: cpe:2.3:a:acme:product:-:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: acme
  tags: cve,cve2024,code,privesc,local

self-contained: true
code:
  - engine:
      - sh
      - bash
    source: |
      /usr/bin/env ldd --version

    matchers:
      - type: regex
        regex:
          - '(?mi)^ldd.+\s(\b2\.35\.?\b)$'

    extractors:
      - type: regex
        group: 1
        name: ldd_version
        regex:
          - '(?mi)^ldd.+\s(\b2\.35\.?\b)$'
# digest: 4b0a00483046022100dafc01a14a51545bf3372f88e904f0f9492ceb7fb243d5b53efdb55f500f7d2d022100c1370ba68c7301a4f6b7b6e37d696f3c29cdb095436352ff6389bf244cfaa9af:81973a0d6a2447da49f1f76e37b0b122